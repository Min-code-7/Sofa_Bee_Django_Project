<h2>User Register</h2>
<form method="POST">
    {% csrf_token %}
    {{ form.as_p }}

    <button type="button" id="send-code">send vertification code</button>
    <button type="submit">register</button>
</form>

<script>
document.getElementById("send-code").addEventListener("click", function() {
    var email = document.querySelector("input[name='email']").value;
    if (!email) {
        alert("Please input email firstï¼");
        return;
    }

    fetch("{% url 'send_verification_code' %}", {
        method: "POST",
        headers: {
            "Content-Type": "application/x-www-form-urlencoded",
            "X-CSRFToken": "{{ csrf_token }}",
        },
        body: "email=" + encodeURIComponent(email),
    })
    .then(response => response.json())
    .then(data => alert(data.message))
    .catch(error => console.error("Error:", error));
});
</script>

